hello and welcome everyone it's January 26th 2024 we're here in active inference math stream 8.1 with Richard seron and we're going to have an interesting presentation and discussion today on introduction to beijan mechanics free energy principle and the state-based formalism this is part part one so Richard thank you for joining looking forward to this presentation and discussion so to you hi everybody so yeah my name is Richard s I'm French working in Switzerland I'm a PhD student at epfl in in loan and just to bring a bit of uh context uh I'm not working on basan mechanics we are uh we do have a physics background but who are interested in modeling bacterial Evolution and ecology and what happened is that something like uh I mean the free energy principle was always in a corner of my head and one year and a half ago I decided to really read about the free energy principle uh especially if I wanted to transition to the field and I do want to transition to the field after my PhD and so I started to ask many questions to the people from the f community and I'm so grateful thanks for them and also on the Discord of the of the active inference Institute and at some point I said that I Was preparing um a lab meeting about the free energy principle and Danielle proposed to have this uh in discussed on a live stream because there isn't such material to specifically learn about uh beijan mechanics and the actual physics underlying the free energy principle and so here I am so once again I'm not an expert uh on the matter so always refer to the original papers but hopefully I going to I going to do a decent job um so without further Ado let's let's start uh I'm not going to tell you uh what we where we are heading what questions we would like to to address or whatever I'm ra rather going to start building the framework right away and at some point what we're doing doing will become clear so as you may know there are two uh formulations or formalisms um of the free energy principle the so-called State based formulation and the so-called path-based formulation so today we will focus on the state based uh formalism it's not like the old versus the new formulation in fact thinking in terms of path or So-Cal generalized coordinates of motion I've been around forever but in the literature but it kind of came back to the front scene of the beian mechanics literature I think anyway today we will focus on the state based for uh formalism so the very starting point is to write down L equation a generic L equation so it's literally like saying let's consider a random dynamical system very briefly for the people not acquainted with uh such an equation x here is uh the state of your system so it could be a simple Scala if you are considering a onedimensional process but in general uh X would be a vector for instance if I don't know you want to um to model the 3D diffusion of a a bronan particle immersed in a liquid X would be a 3D Vector where components are the coordinates of your bran particle and you can see on the left hand side that we have DX over DT the time derivative of the state Vector so that such an equation really describes or specifies the Dynamics of the system so many things can influence indeed the Dynamics of the system if I stick to my bronan particle example maybe it is subject to an external force uh so whatever is relevant here you put it in F the so-called deterministic term or flow we will refer to it as the flow throughout the presentation however in some cases there is stuff you don't want to explicitly model for instance if I stick with my bronan particle example uh it is constantly hit by um the molecules of the med surrounding it hence its bronan motion right and it would be so if you want to take into account this termal fluctuations it would be mission impossible to explicitly model every single molecule of the millions if not billions of the molecules surrounding it so a convenient way to still take into account these fluctuations which are literally thermal fluctuations in my example a convenient way to proceed is just to add a noisy term to the equation so Omega here is uh a random variable was value changes with time uh with the appropriate statistics okay so two brief remarks before moving on if you assume that the state of your system changes slowly compared to the time relaxation of your um of your fluctuations you can write the autocorrelation function of the FL of the noise like that where gamma is the diffusion Matrix and Delta is the Delta direct function so what it means it's just that in that case your noise is super rough and it's not correlated in time basically also second remark you can uh I mean you can use the central limit theorem to argue that that that um that it makes sense to assume that Omega is normally distributed so that in the end um the noise is a Goan white noise but not that in the next next live stream where we will discuss the path base formulation of the FP we will Relax The White Noise assumption anyway so we have this uh random dynamical system and we can do something cool with the flow so the flow f is a vector it has the same dimension mention than the state Vector because each component of the state Vector has its own L equation if you will and you can decompose it into a solenoidal and a gradient uh terms so we before sorry before telling you what this decomposition is all about on a technical note just notice that first Q here is the so-called solenoidal Matrix gamma is the diffusion Matrix just as before and the I here in the with the NAA ey this I of X here is a negative log of a density so it's a self-information or surprise we will refer to it as as the surprise throughout the presentation and the density at play here in this negative log uh density is the steady state or Ness for nilib brium steady state density of the system so we assume that that there is such Nest density that exists so that if you uh from a given initial um in initial State you let your system evolve it will reach at some point uh unique well defined um Nest density and second remark before telling you what this decomposition is all about not that usually in the papers the Divergent terms here and here are put together on in a third term uh which is uh which is sometimes called the housekeeping or correction term but actually if q and Gamma are not State dependent these uh Divergence terms vanish anyway and we uh end up with this the two remaining terms which can be nice nicely factorized like that also a last thing I want to say is that if you uh you consider the solenoidal term the first term it is indeed a solenoidal term you can indeed write it as the rotational of some potential I'm saying that because sometimes people get confused when uh they see a gradient in both terms anyway what this uh the composition is all about uh is quite in fact simple let's consider uh this nice 2D single moded uh Nest density okay so the flow and more specifically the gradient uh component of the flow which is here the vertical flow will drive the system towards its mode while fluctuations kind of push it away but it's not the only flow there is also the solenoidal flow which is here the which is here called the horizontal flow which uh will make the system kind of converge to its its mode in um with ever decreasing cycles and so if you want to get some more intuitions on this solenoidal flow what we can do is to remove the fluctuations so all the entries of gamma the diffusion Matrix go to zero and this means that we would not have any gradient flow anymore we end up with only the solenoidal flow and if we do that uh the system will uh just follow n Contour circulation on the nest density that's the bottom right um panel here where the Solen the solenoidal flow sorry kind of drives the system on this circulation here so a small remark about this solenoidal flow because it kinds of um Drive the system in um in this simple example in either clockwise or anti anticlockwise Direction in a irreversible fashion irreversible in the statistical physics sense um so it breaks detail balance and so on people sometimes view this solenoidal flow as the writing the Symmetry breakings ubiquitous in living systems anyway okay so before using this decomposition of the flow to do some cool stuff I need to introduce some stuff so I will have to go through a couple of things of Notions one after the other and afterwards I will um we will put everything together and actually derive the free energy principle so the first thing I want to uh introduce is the notion of Spar coupling so let's say that in my state Vector X here I have a subset of variables this mu here we refer to as the internal States and they specifies the state of some subsystem called me so I mean you get the idea the the idea is that we have like an organism an agent the bacteria in my schematic and these variables here literally specifies the internal states of my bacteria and this bacteria uh is in a given environment Niche whatever so there is this other um subsets of variable we refer to as the external states and which corresponds to the external uh world the the external States of the back of the bacteria and the idea here is that these two subsystems are uh are not connected to each other so when I'm saying that two variables are not connected to each other I just mean that um their respective flows do not take the other one state as argument so they do not influence each other basically in fact they are indirectly connected to other thanks or through a third subsystem we refer to as the blanquet the mark of blanquet so that these guys here are called the blanket States and we will see in a minute that it it really corresponds to a mark of blocket in a statistical sense okay so we have this um this uh architecture this par cing architecture here and in fact we can even go a bit further and I assume that within the blancet there are two more systems the so-called sensory States and the soc called active State a so basically the idea here is that the external State ITA they influence the sensory States s and these sensory States s influence the internal States me but not the other way around and the internal States mu influence the active States a which influence the external State ITA but not the other way around so it's really uh a sparse coupling architecture inspired by the so-called action perception Loop however we you you could ask questions like why do the sensory States influence the external States or why do um the active States influence the internal States Etc so we don't have really time to discuss this I guess you can think of some qualitative example in biology but I just want to point out that even though this architecture is quite canonical it's not a definitive feature of the free energy principle and in fact in the next time when we will discuss the other formalism we will do a bit of zy and we will look at other Spar coupling architecture okay so uh on a technical note just notice that such uh Spar copings are encoded by zero entries in the Jacobian matrix of of the flow anyway so thanks to this SP coupling architecture we have this this system of four coupled uh lement equations which respectively describes or specify um the Dynamics of the external state ITA the sensory and active States s and a and of the internal States mu okay so I want to um to say here about the mark of blanquet thing that under some conditions I'm not going to discuss here so for the people acquinted it involves having no solenoidal couplings between autonomous and not autonomous States but anyway I'm not going to go into this let's say under some conditions the external State ITA and the internal States mu are conditionally independent so they are independent when conditioned up B which makes sense because all the informations kind of Transit through through b however not that what when I'm talking about conditional independencies here I'm talking about conditional dependencies in the stationary density so basically if you fix p and you have this joint uh conditional stationary density here for XI and XJ if these two guys are conditionally independent it just means that you can write this joint density like that and so that such conditional uh independencies are encoded by zero and in The asan Matrix of surprisal okay so now just a bit more of vocabulary before moving on um note that if we um put together a and mu so we consider the couo active State and internal States we refer to to these guys are as the autonomous States Alpha and the cool thing about the autonomous States a and mu or Alpha is that they are conditionally independent of the external States so autonomous and external states are independent when conditioned open uh sensory States and if you add the sensory State s to the autonomous States so so you consider the world thing the world marker of blanquet and the Act and the internal States we refer to to these guys as the particular States pi and Pi constitutes a particle a particle in a generic sense of course so an organism an agent whatever a bacteria in my schematic okay so here I just want to make a a point to make a bit more clear what we are doing what this this approach is all about so basically here we kind of Define what it means for something bacteria any whatever to exist in the sense that it has its own internal Dynamics statistically separated from the the external it does have a mark of blanket it does have its own physical Integrity so we have no clue of how it maintains indeed its its um its Integrity in the sense that if you're considering uh real systems like like an like an actual bacteria or a human being or whatever it it does survive at a given in a given time scale um by for instance displaying I don't know like active processes contouring dissipation for instance here we don't say anything about how it does survive it just does we do have this pass coupling architecture and from there from the starting point we are going to derive the the the necessary uh consequences of such sparse coupling so basically we kind of ask or answer to um or try to answer the questions uh if things exist what must they do and so if you're a bit confused don't worry we're going to go back to this idea later but I just want first to show you this quote here which tells you many theories in the biological sciences are answers to the question what must things do in order to exist the FP turns this question on its head and asks if things exist what must they do but once again we're going to go back to this idea later but that's kind of um the idea of this approach in a nut so as I told you uh I still have a couple of things to to present so I will have to go through each of them one after the other and finally we will put everything together and finally derive the free energy principle so the next thing I need to introduce is the notion of synchronization map so very uh very um generally speaking I'm not specifically here talking about our random dynamical system if you have a linear map uh GM here which gives you mu from B and G here which gives you EA from B then uh if G mu here is injective so that basically you can go back to the pre-image from the image you can use the pseo inverse of G mu so that from mu you go back to B and from B you can go back to you can go to Ita so the successive application of the SoDo inverse of G mu and then of G is called the synchronization map and it basically allows you to directly go to Ita from mu okay so now let's try to uh to use this idea in the context of our system so here corresponds to the blocket states so if I fix the blocket states I have a corresponding uh conditional densities for mu and ITA I have P of mu given B and P OFA given B and I and what I I and their um their modes are bold me and bold ITA so in virtue of this synchronization map I can go back to the external mode from the internal mode thanks to once again this synchronization map here and I'm going to give an example in a sec which is going to to to make to CL clarify a bit more what we are doing here but first I just want to say that in this nice paper by lens Daka uh about this this this synchronization map basically everything was Gan but uh sometimes uh I mean if it is not the case a laas approximation which which is literally a Goan approximation might be necessary to derive a synchronization map of close form but don't worry we'll go back to this idea of laas approximation later just remember that we have this synchronization map here which allows you to go to the external map uh external mode sorry from the internal mode so for instance if given B given the blanket States the uh uh corresponding uh P of AA given B follows this nice normal distribution where bold um bold uh ATA here corresponds to the mode then in virtue of the synchronization map I can view the internal mode mu as parameterizing a density I write it that way Q mu which is equal to this nice normal distribution where the mode is just the synchronization map applied to the internal mode to itself and by construction of the synchronization map it is equal to the true external density so you can view the internal mode as uh parameterizing a distribution over external States basically thanks to the synchronization map that's why what the synchronization map is all about so just a small point because maybe some of you are a bit confused here because we're talking about modes as opposed to actual States so we we will talk about that later but indeed uh I mean if I take the actual internal States at a given time T they are not necessarily equal to their modes just because of fluctuations or whatever so that if I apply the synchronization map on the actual internal States it might not give you the true external mode but anyway we will discuss this uh a bit more later so that was the notion of synchronization map in a nutshell basically so last thing I want to uh to introduce before finally putting everything together and actually derive the fre energy principle is the notion of variational inference so very simply let's say that you have some latent variables or hidden variable or some um latent generative process causing some data s so you have a prior P of AA over the state of these edden causes of data and you are also equipped with a generative model which just designates this joint distribution here P of ETA and S so you can view it as a model of how the latent variables C the data so the idea here the is the following you sample some data s and you want to compute the posterior distribution P OFA given s so in a way you want to refine your belief about the the the hidden code of data thanks to a new sample data so it's very simple you in principle because you just have to apply base theorem right however in Practical settings the denominate the denominator here P of s so the marginal density over sensory data usually usually requires a monstrous marginalization so it it's just not tractable so we can't just apply a base theorem so we need we need a method uh which given some variation sorry which given some some variational distribution Q also called recognition density uh gives us uh I mean we want a method that makes it as close as possible if not equal to the true distribution we want ultimately to compute namely P of EA given s and this two density so Q our variational distribution and the true distribution P of ITA given s are equal or are more or less equal if their Divergence can Divergence here is zero because this quantity here the K Divergence basically measure the difference between two distributions so that's what I wrote here on the top of the slides finding an accurate distribution Q in the sense of finding a q as close as possible if not equal to the true Target density is equal to minimize to minimizing this Divergence however this Divergence I mean there is the target density appearing here we can't do anything directly with it we can't compute it or whatever we need a proxy for this target Divergence and there is a proxy called variational free energy F in Green in my in my slide here so f is is equal to this Divergence here between Q and the generative model and the idea here is that you can decompose this Divergence into the true the targets sorry into the target Divergence in red here plus something so it is indeed a proxy for the Target Divergence and note that interestingly enough the second term here is the surprise over sensory data or negative log p of s so that f is can be viewed as an upper bound or lower bound depending on how you define it uh un surprise okay so what I just said here is that minimizing the target Divergence just means minimizing F so that's basically what variational inference uh is all about and not that usually algorithms require Q to be Goan or require meanfield approximation or whatever and if uh Q is required to be gotian even though the target density is not gotian we would end up with uh the best Goan approximation of the target density basically and in practice it would mean working with a so-called laas encoded um free energy okay so before moving on I just want to say that uh the this quantity the variational free energy is in itself a quite rich and interesting quantity so you can decompose it in many ways and each decompos uh provide interesting uh interpretations for instance if you look at the second line here you can see that minimizing free free energy means um um maximizing this accuracy term here you basically want to explain the data I would say but at the same time you you want Q to Def the least possible from a prior distribution so that's that's um an interesting quantity anyway now let's finally go back to our sparely coupled random dynamic system and use everything we we talked about and finally Let's uh derive the free energy principle so here is our system and we have these four L equations and the first thing to do is just to apply the decomposition we talked about in the beginning so basically the flows of each of them can be written like that so I just directly applied the helmo decomposition we talked about in the beginning okay so now um let's try to understand uh how it works let's talk about the Dynamics of the system let's say that uh so there is a momentary instantiated uh uh sensory State and let's fix let's say that the sensor state are fixed and there is a corresponding autonomous dens uh autonomous mode toward which the autonomous states are going to converge and stay in the vicinity of the of their mode in the close vicinity if uh fluctuations are not too large okay but in fact sensory state with time changes uh so that the the mode of the autonomous tape move as well and in fact it it moves on its corresponding autonomous manifold so I'm not going to go into the details but just have in mind that the autonomous mode moves on a so-called autonomous manifold which can be viewed as a statistical manifold and which can also be viewed as a so-called Center or sent manifold so if I kind of rephrase what I I'm saying here is that the flow of the of the the autonomous States can be decomposed into a off manifold flow and uh on manifold flow which corresponds to the path of the mode itself on the manifold okay so just to be a bit more clear let's say in my bottom right uh illustration diagram here the autonomous states are are here and I'm I'm uh interested in the the off manifold flow so basically I have the this component here which corresponds to the gradient flow towards the manifold towards the mode basically here it's pretty much like what we discussed in the beginning and at the same time there is here this orthogonal uh component which corresponds to the solenoidal flow so that's basically the way the autonomous states are going to reach their mode here it can be viewed as this uh ever decreasing cycle towards the the manifold on which the autonomous mode move uh okay so that's a bit dense I guess so I recommend to check the paper the free energy principle made simpler but not too simple which kind of um disuss all this um these ideas about centor manifolds and stuff so here the interesting point is that if you assume a separation of time scale between the fast flow of the the manifold as opposed to the slow flow on the manifold basically the autonomous State always are are always in the vicinity of their modes and if you want to characterize the overall dynamics of the autonomous States you can focus on the autonomous mode on the path of the mode and in the next slides we will indeed focus on the autonomous mode um and and by definition as we already uh discussed the autonomous mode the autonomous mode is or corresponds to the autonomous states which minimize um surprise here in the last two lunch my equations because the autonomous mode corresponds to the least surprisal autonomous States before moving on I just want to say something H we can maybe discuss afterward because I'm not sure to fully understand but basically if I'm here in my bottom right schematic and so I have this gradient flow towards the manifold and this solenoidal flow parall to the manifold and if I remove fluctuations so all so the the the corresponding entries in the diffusion Matrix go to zero as we saw in the beginning it's it it means that there is no uh gradient component anymore and what the system will be doing is kind of um orbiting or oscillating around a point which is which moves the manifold so that's interesting and I guess that if we do the exact same reasoning but starting already on the mode then the wall flow reduces to the on manifold flow and I guess that in that case the autonomous States follow and in fact coincide with their mode but anyway maybe we we can discuss about that afterwards so okay so let's use the various things we talked about and especially the notion of synchronization map we as we said the internal mode parameterize indeed um a distribution over the external state so me here um parameterize a distribution which by construction coincides with the true distribution P OFA given B and in fact thanks to the conditional Independence between external States and autonomous States you can just drop the condition Upon A and you just have q mu equal p OFA given F and equivalently you can um you can write it P of ITA given pi and um the idea here is that you can view Q mu as a variational distribution if you want you can write its Associated variational free energy so you have this um this formula here the free energy and because Q mu is already um already coincide with the true posterior distribution if you will the first uh term here goes to zero and so that F here reduces if you will to the surprise of particular States and surprise over particular States they appear here in the equations of the autonomous States so we can do this identification and we realize that the autonomous uh mode not only minimize um not only minimize surprisal but free energy in general and the way uh me the internal States will be updated when the sensory States will change will always be so that this Divergence here is zero so that mu is always always keep stke or synchronize with or in fact infair the external States so that you can interpret that under a generative model which is here P The Nest density the internal States can be viewed as performing inference over uh external States and so in fact it's not only this Divergence which is minimized but it's also surprise and it's not only um only the internal states which uh minimize free energy but also the active States so let me give an example let's say that the actual uh instantiated sensory states are likely sensory States or unsurprising sensory States and by definition in general the instantiated sensory States will be likely sensory States so mu will will the corresponding mu will be so that this Divergence will be zero as we just discussed and at the same times the corresponding active mode will be so so you can see composition with the first uh term here I of a given s and mu a the in active mode would just be the one the most consistent with this in inated sensory States and in fact you can view it the other way around and say that the active mode is the mode which yield unsurprising sensory States so that the particle can be view viewed as uh actively sampling unsurprising or likely sensory States or equivalently you can say that the particle kind of um accumulate evidence for its own generative model and I'm going to say something about the generative model in a sec but I just want first to so yeah this sentence here just sum up what we said mu is updated so that Q mu is always the um the best distribution over external States and we refer to this as perceptual inference and the idea to in addition Trying to minimize your price for Action is called active inference so a brief note uh we said earlier that in order to have a synchronization map of close form it could be necessary to work under a lapas approximation so that in that case Q mu is is is is just the best Goan for instance of the target density so that the Divergence here would not be zero but it still would be minimized so that the identification here between the two gradients still hold and nothing change um nothing changes with respect to our discussion so here I I just want to say something about this uh what we are doing here basically we assume that we have our agent or organism that survives indeed exist or persist in a given environment let's say at a given time scale and we end up with the fact that our particle must be equipped with or must be must embody um a generative model which may or may not exactly coincide with the true generative process and which encodes the caal structure of the world under which it tries to perform inference and to minimize surprise to perform from perceptual and active inference but the interesting thing as well is that and I think that's something fundamental that people tend to misunderstood I guess maybe I'm not sure is that the generative model also encodes uh the preferences of the system and let me explain why if I tell you that an organism manages to survive to exist to persist Etc and so it means that such uh an organism manages to stay in its ostatic life compatible uh States you would be of course it almost sounds like a topology uh survive equal uh uh staying in it in in its homeostatic State that's obvious right and that's exactly what we are doing here we assume existence survival so that the likely state in which the particle will will persist are preferred States per se so that for instance if I'm considering the prior of my generative model over sensory inputs p ofs uh sensory outcomes as associated with high PS so likely or unsurprising sensory states are three sensory States states hence when I'm saying that the active States try to sample unsurprising sensory States it means trying to sample preferred sensory States and so uh basically the particle appears to kind of uh actively uh accumulate evidence um uh for its own existence in a way it kinds of sample life compa to it kind of stample Life compatible data if you will and that's exactly the definition of self- evidencing so I think we touch here something fundamental about agency is that agents are self- evidencing creatures in that sense okay anyway so um basically I think that's the most uh interesting things of the free energy principle we start from existence and we end up that such a particle which is coupled to the world in that way must embody a generative model which encodes the caal structure of the world and which encodes the its preferences in terms of what is life compatible if you will okay so just to sum up what we did here this idea that free energy is minimized uh you can write it that way and this is in a way a variational principle for self organization that's a free energy principle so here I just wrote what we just discussed the agent keeps tracks and acts on its external mil through perceptual and active inference um and note that interestingly enough you can write such Principle as a principle of least or stationary action where the lran which is constantly minimize the longer path is variational free energy so here I are some concluding REM remarks I'm not going to through all of them but the first one is basically what we just discussed this idea that the generative model um encodes preferences if an agent maintains existence its likely States or its preferred ones per se the notion of self- evidencing and I just also want to point out that this new approach uh or chapter of physics let's say consisting in um describing physical systems as encoding probabilistic beliefs is called basan mechanics okay so having said that uh thank you very much and especially thanks to all these guys who who helped me so much especially Lance uh and uh yeah thank you for um for your uh your attention coming back thank you Richard okay well while we're settling back in and anyone is asking questions in live stream what is your PhD research and if this is your side project what is your main project that this kind of relates to yes so well in fact um I kind of read about of fre energy principle in my free time whenever I I had some time and the what I'm doing uh in my PhD is um so we have uh a couple of projects the first project we did was really modeling bacterial Evolution through so basically we model bacterial Evolution as a bios random work on genotype space with um successive mutations and and and and successful fixations so that's what what we are doing it's not related to the FP at all um and the s thing we we have been doing is um modeling uh so basically we had a system where you have bacteria which can kill each other thanks to a system which is called the T6 secretion system they kind of have needles with which they can go through the membrane of other bacteria and and liberate toxins and they can also bind to each other so there is like a prey predator kind of Dynamics and we did like a ltis gas modeling of such systems so basically that's what I'm doing in my PhD uh which is not related to to beijan mechanics but I would like to to transition to to the field afterwards so yeah we'll see how it it goes a I remember when I thought my PhD wasn't related to active inference okay cool well the work built to an amazing Crescendo that in its Simplicity even though you highlighted it's easy to fly by which is The Coincidence of the preferences and the expectations so could you maybe give a little context how else has that Nexus of preference and expectation been approached and is the Fe only and simply and always that coincidence is that coincidence upstream or Downstream of some other commitment that we make like what are the commitments that we really make and is that um alignment the commitment or a resulting commitment yeah so um so first of all I think the notion of um self- evidencing may be a bit refined with the next formulation but anyway it's I think that's a crucial Point uh about the F and usually it's kind of confusing because when you're reading the papers and people are starting to write that the system um sample evidence for its own existence you're like what I mean I'm not sure to understand what's going on here um but in fact yeah it's I I think the the way I I I um introduced it this idea that by definition um a living thing is a thing which which manage to uh sample life compatible uh sensory data is really what uh allows this um Al align alignment sorry between the that the idea that between surprise and preferences is basically and this idea that actively sampling um unsurprising data is in fact and it's not like a tricky wording it's in in in a way that's really what's happening it is uh sampling uh life compatible or preferred in that sense data hence the notion of self- evidencing um but um yeah I think the world idea here is that we start from existence we start from the uh from this pass coupling architecture where the particle uh managed to maintain its physical Integrity managed to display a mark of blanket which uh allows the the agent to have its n its um its own internal Dynamic separated from the external so somehow it managed to cont dissipation or whatever and so from there likely states are states consistent with the fact that it is existing existing indeed so I think that's basically the the the idea but yeah in the beginning this kind of um line of reasoning can be a bit confusing but in fact I think that's very much what the FP is all about and actually last remark um in a machine learning Street Talk interview of Maxwell ramstead he it was titled the FP as um a physics of survival if I remember well and I think that's that's very very much what what it is all about in a way awesome how would you relate what you just described to reward or to reinforcement type learning schemes yeah so I I mean I'm not um an expert at all I could not uh make the bridge here but I know that um Lance D Costa made several uh works and interviews about the the subject and actually I think there is a very new paper called active inference as a model of agency you just shared actually today um so I yeah I recommend the viewers to to check them out and as far as I know but here I'm just I'm just um saying what I heard is that um any reinforement learning algorithms can be um can be framed in terms of active inference so I think active inference is is a very um uh fundamental scheme but yeah yeah it's all good like the reason I ask just with how you presented it is what kind of observations do we want to sample that could be the sensory embodied interface between the agent and the environment or you can take more cognitivist approach and Sample internal observations but those are just external some other internal so what do we want to really sample well if you're even in a position where you're talking about sampling from like a utility or a reward distribution you've already specified a distribution why not just specify the existence distribution the actual attractors and stationeri of the measurement and then um it's simpler because there's no proposal of a secondary intermediate between the temperature and how good different temperatures are by going and just saying it's not rewarding to be at 37 homeostatic temperature it's just expected and likely and the ball runs downhill it's actually a lot simpler and more General yeah I and I I think that um it's way more simpler to I mean the idea here is that the agent has a kind of world model which as you said uh specified what what are the the expectation uh with regards to just existing in a way and as opposed to uh designing EXP itly um um um uh objective functions um uh with the which incorporates the Notions of utility and so on so yeah I'm very much agree um earlier when we were looking at the flows and we have the breakdown of a flow um could you maybe just [Music] um what animal are you thinking about or What scenario can help us understand like what's the solid black line what's the small red line what's the spiral what's like a physiological setting that we could associate here to help us understand that kind of complex movement yeah so generally speaking the first thing I could say is that this notion of solenoidal flow so it's like in the schematic schematic in the first slide where you have you had this EO Contour circulation on the nest density or here the the the component of the flow which creates this sort of spiral here it can so that um it's these sort of um oscillations are I think uh the sort of oscillations or cycles that are aitous in living systems um I mean I'm not a biologist but you can uh or not really a biologist but you can think of the Circadian cycle or or anything in any sort of systems there is this thought of of of um attractor where where you circulating along and so here specifically to this to this um a schematic here I think the idea is that um um you have so you have you you basically let's say that uh for a given sensory State you have a corresponding autonomous mode and the when the sensory State change the automous mode mode uh changes as well and in fact move on its So-Cal manifold so basically I guess here you have the mode moving uh on its manifold and now if we take uh the perspective of this autonomous States here we uh converge to the the manifold to the mode U and because of the solenoidal uh component of this flow the way we will um reach it is with this kind of um ever decreasing Cycles um so here's the idea and and um I I really recommend here the free energy principal simple paper you have the the flow on the manifold it's just the path of the mode itself let's say and you have the flow of the manifold was gradient component is the flow to towards the manifolding in fact um so basic so that's basically how autonomous States kind of um react to to to sensory data which change the autonomous mode and I think the well an important idea here is to assume that the flow of the manifold is fast as opposed to the flow on the manifold so that basically the sensory state are always uh in the vicinity of their mode and move with their mode and um sorry and um and um and yeah I think that's pretty much the the idea here okay so let's just say that the black line is um our homeostatic body existence life compatible pH oxygen blood sugar and yeah we are that light blue dot that's off that manifold of course if we were far enough off to be dead it would be a moot question but we're off but within a a life um scaffolding or compatible Zone and now as time pushes us down into the right um there are different slices that we can trace um we could take the shortest path the gradient flow directly towards the manifold so as that plays out through time it would look like a linear line converging to the thick block line or Pure solenoidal Flow would just stay equally far away from the thick block line and continue to spiral so that would look like a cork screw uh through time and then here when you have the combined character of the linearized convergence to towards the manifold and the cork screw out through time we get this kind of winding spiral so it reflects on me that the gradient flow is pragmatic value in that it aligns future observations with preferences and the solenoidal flow has an almost epistemic character in that it circulates amongst a set of equally valid outcomes yet here we're not looking at the pragmatic plus epistemic decomposition of the expected free energy policy selection strategy like equation 2.6 in the 2022 textbook so is that just a concordance or where do you see some of those topics connecting um I I'm not sure maybe uh but having said that on this on the the meaning of the solenoidal part here I know that on the on the uh I don't remember if it's in the free energy principle simpler paper or or someone else but there is an analogy or I mean they discuss the the meaning and the role of the solenoidal flow where they say that it it it kind of help um it kind of helps mixing uh the systems and you can view and they discuss the metaphor with where you want to dilute your um your um your coffee for instance and and you're going to have this sort of uh Motion in order to reach the the as fast as possible the stady state where everything is diluted but I I um I'm not sure I didn't think enough myself to provide any sort of interesting Insight all good just to have composed it is very insightful um well you made choices assembling things like what do you feel like would have been background maybe a course or a skill well background do you feel like you kind of conditioned upon that somebody might want to check out and then what do you feel like you would have wanted to include in the state-based formalism um because to to bring it into a under one hour timing is very concise so where do you feel like somebody could fill in some background to pick up with you at the beginning and then what else do you think would make a fuller presentation I think I mean there are a few aspects and details I didn't really uh like fully uh discuss um well first of all all these um things which inv here which involves like C Center Theory a center manifold Theory and stuff like that uh we we kind of played U qualitatively with it we didn't truly go into that and also if we want to be like full really full formally speaking um let's see maybe um uh well there are a couple of things where we that we kind of accept without really checking all the assumptions and all the deriv derivation and I'm especially thinking of the of the helm how DEC composition of f because of course you need um a steady state n density to exist to in order to have such uh a decomposition so here I think it's it's there is um a lot of stuff to to check and I mean there is a nice um I think it's in the appendix B of the beian mechanics of stationary process paper by lens where it he he derived the the helmo decomposition uh so yeah there are quite a few things we kind of state without um derive so it can if people are interested in in going further I think that's kind of interesting formal uh directions um and um um yeah cool I think it'll be a really fun collaborative project to auma tize and formalize and modularize using the ACM onology and understand a lot of these um relationships and then the other piece that that made me think about is like what work is any of this math doing at all just kind of like the the ultimate existential question here um and when we condition upon existence we've kind of like off sourced a lot of cognition we don't need to make the jump or the walk or the miracle from Axiom to embodied existence or to even measured hypothetical existence so that is left unaddressed the margin was not big enough but it wasn't even addressed and maybe there are even advantages to leaving the um what happens before the conditioning you don't want to take it with you after you condition upon it that's the whole Markov blanket concept like if you're like well I'm conditioning on 5 years ago in the present but also I'm carrying 5 years with me today well then it's like well then it wasn't conditioned upon so to really condition upon measurements is an extremely radically simplifying maneuver that may change the scope or the applicability of the framework relative to a conception in which what the free energy principle does is describe how things come to be however yeah this rather conditioning upon it opens up up that discussion and more circumscribes this very analytically tractable setting of the agent and the environment across a conditional interface Yeah by by the way about about the conditional thing there is now the notion of you know weak Mark of blanket that dalon introduced which can of lose the the the the approach let's say and and um because indeed there is a question on I mean does it apart from the the formal setting we have here can we really apply to real systems and stuff like that and um and also I think it's a physics of survival uh in itself uh at a given surv at a given time scale there is at if I at a given time scale we survive indeed in the sense that there is indeed this partition or conditional Independence between the internal and external here is a physics you have to comply with but we it didn't tell you tells you how the mark of blanket arise or whatever it's it's it's it's just not what it is designed to um to explain um but um I think generally speaking it's It's really informative uh because for instance if you are considering the um I mean this sort of approach in general I mean for instance if you consider the pulum um effect where where you put pum oscillating on the table and they are going to synchr synchronize with each other and I think TAA is Aura did a paper about that recently um in order to understand what is going on and why the pendulum synchronized at some point you just have to recycle all all this line of reasoning with the synchronization Maps that's very what is at play and what explains why the pendulum synchronized when they are both on the same table so I think it it it it really it is really informative to in order to understand what is going on when we are talking about synchronization phenomena across sparsely coupled systems and also it gives you I guess the sort of recipe to understand what it what it um what it takes to be an agent if you want to design your uh an intelligence uh system um and um but uh yeah the question of how much useful it is uh beyond the fact that it's just some nice formal framework it's it's an interesting um interesting discussion yeah and I I I um I uh just two things first I would like to go back to your previous question about what sort of things could be could be discussed further I think an interesting uh point we didn't really uh discuss fully is the notion of synchronization map because uh we didn't necessarily discuss the the the hypothesis and stuff uh about the synchronization map and I in fact I think there is um much things that can be said uh for instance because we assume injectivity thanks to the rank nity theorem uh it kind of constrain the dimension of the internal manifold here with respect to the blanket manifold here and it kinds of constraint in order to have injectivity thanks to the Rong nity theorem and so it kind of constrain the the the in order to say it in a qualitative fashion it kind of constrain the the complexity or richness of the internal States uh which speaks nicely to uh other Frameworks like um uh like asb's laws of requisite V Varity where you want the regulator system to to be as um as sophisticated or as reach to the regulated systems and here you need the internal states to be enough uh complex to uh or to constitute the sufficient statistics let's say to parameterize to be able to parameterize the density indeed um and this um and this U richness let's say is constrained by the the cardinality of your sensory channels if you will U because basically you need the internal manifold to be to have the same Dimension than the blanket manifold or the sensory manifold to be to have the same Dimension as the autonomous manif fold um so I um I mean I think there is many things to discuss about this um this aspect here um and and the last thing I I would like to say about your uh about your last question about the applicability of the framework and how much it's useful has supposed to be a simple elegant formal framework I think so you know there is this um these papers about um um about like the mark of blanket trick and stuff like that uh about how much difficult it is like to identify what states corresponds to the mark of blanket or whatever um and and I I'm personally I'm not really convinced by this um these critiques um because to me is like to me it's like saying to Newton yeah I mean it's um I'm not sure that I can do anything with your framework it's it's complicated if not impossible to model systems with clearly identified and separated roads and masses let's say uh okay fine but we are talking about Newton mechanics here so I mean I think it's the the same here it's if you have a sply couple ROM name because systems that's the sort of behavior it will display it tells you fundamental things about the nature of living systems and the idea that when it comes to a specific system it can be quite tricky to to model it that's another questions um um and indeed when it comes to the art of modeling complex systems it's it's it's interesting and and we can discuss about how much complicated it can be to apply the framework um yeah awesome I love that it's like the art of the science and the Art of the modeling and and the and the craft especially in the kind of early handbuilt largely custom stage like one thing I even wondered looking through these slides um what fraction of these representations and formalisms exist only analytically and do or is there a code representation of this exact scenario or you know are some of these areas equations that don't [Music] have code realizations they're just pure existing equations so I mean I think um more or less everything here can be um can be simulated even this synchronization thing here you can um perform simulations where you can really literally see within the simulation the synchronization um and I mean the the the world thing here can be you you can simulate such parly cical systems and and kind of um interpret the dyamic in did as the way we we frame we frame it um but um but yes that's also an interesting uh aspect it could be cool like in the GitHub repo in the journal for this transcript or something like that to to curate together the simulations that demonstrate or a minimal specification for it um yeah because it's it's is um yeah and actually there is um I mean I think it's in the in in lens paper about um synchronization map the visian mechanics of stationary process um processes paper there there are some simulations where he shows that um I mean it shows the the synchronization map at Play and it shows that basically you can't go back to uh I mean if the the the map between the blanket states to the internet States is not injective uh and you apply the synchronization map to uh the actual sensory uh to the actual internet States it gives you like some nevant things and there are some nice plots from simulations so that's yeah definitely a paper to to check out Co so where do we land and then how do we sleep exercise relax to prepare for part two yeah so I think here's the world point was I mean the the this world formulation is in a way about the momentary the short the shortterm and the momentary response to state to sensor um stimuli let's say um if there is this uh this um I mean the kind of instantiated active states are so that outcomes whatever but in the next uh video where we will look at the path based formulation of the framework the world idea would be to ask what about path and what about Future Path and what about the long-term Behavior Uh and what about planning what about higher order cognitive abilities um and we we we will kind of extend U the scope of what we are doing in in in that sense um but um yeah I mean I think from a formal point of view uh here I kind of introduced many things varation um varal inference synchronization map Etc one after the other before actually driving the Fergy principle next time I think we will it will be more straightforward but the the main Concepts to to which will be at the core of the of the framework and which can be confusing if it's the first time you you look at it is the notion of uh of um generalized coordinates of motion when you relax the White Noise assumption and that's something that can be confusing especially for the physicist because when you're starting saying yeah the generalized LR gen it plays a role of an action or whatever they are like no but LR gen is not an action what are you talking about Etc but when you get acquainted with the the world construction is very elegant but that definitely something uh people can started look at before prior to the the live stream yeah awesome yeah well it was excellent you you brought a lot together and a lot of trails leading off this Trail and the citations and previous um papers that that also brought things together Lance's work and others and it's going to be awesome to see part two so thank you Richard thank you very much Daniel thank you all right see you bye by