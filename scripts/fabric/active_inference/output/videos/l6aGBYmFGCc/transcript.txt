hello thanks everyone for joining it's March 29th 2023 we're in cohort 3 having our first discussion on chapter five so before we go into any questions or look at the text does anyone want to just provide any general reflection or thought on chapter 5 or just the first half of the book up till now just unmute and go for it if you want to okay let's look to chapter five and then um I'm sure people have many thoughts as we get going any general thoughts on five or on this opening quotation about plants and animals well there are plants that move and the the there does seem to be some um thought that there are interconnections between um uh plants that they have a something that while it is not a an animal uh central nervous system they have they that there there are patterns within the um architecture that have similar functions and it's the timeline over which they operate is much longer I very much agree with that here's my PhD advisor Deborah and a paper from 1989 describing the plant's Behavior idea and then I believe a more closer to our area is this 2017 paper on plant predictive processing with friston so agreed the the this quote it's a little bit of like time scale dependent it's just kind of like a it's a fun first pass but isn't that interesting that it's like it's actually not so Stark or the plants that do respond like the Venus flycatchers and everything but here in this chapter we're going to be focused on the mammalian nervous system and body not the morphology of the nervous system or like morphological development okay anyone please just raise your hand or or write something otherwise let's just go through chapter five and just look at some potentially interesting pieces this is an interesting concept that not every variable depends on every other variable and that's sparsity and so there's sparsity in the brain there are many connections but of the space of the possible it's quite sparse and similarly in statistical models the sparser they are the easier they are to fit doesn't mean that it's going to be better and a lot of modeling is about finding the trade-off point between like model complexity and model accuracy because if you enable every Edge it's going to be a really laborious calculation but if you restrict edges that are actually important you might have a very rapidly fit model however it might not reflect some of the importance true causal relationships amongst variables so that comes up in different ways let us take a step back from the technical material of chapter four everyone breathes aside and turn our attention to the process Theory's accompanying active inference here they point to the difference between a principal free energy principle which is that systems are described by their Dynamics on free energy Landscapes and that persistence is associated with reduction of free energy to the extent that agency is exerted and a process theory about how any given system may actually Implement those kinds of Dynamics so a principle cannot be falsified and this is at the root of a lot of questions and commentary around like the falsification capacity for the free energy principle and the simplest thing as far as I've seen is neither can a linear regression be falsified it's just not within the space of being confirmed or rejected or falsified by anything at all it's just a proposed model framework as a principle now any given linear regression which is a specific hypothesis about how that principle of linear regression or the principle of the L2 Norm might be implemented that given linear model might be adequate or not more adequate or totally inadequate or however but it is more subject and answerable to empirical data so free energy principle is not really in the space or the game of falsification or not nor does it even engage with empirical data directly whereas proposed and manifest models are directly addressing empirical data and empirical data speak to their validity so none of the above chapters that we've read could be falsified by any observation in the world or they're just kind of theoretical whereas the models that are going to start to be shown in in chapter five are going to be structural and computational hypotheses about models of the nervous system and this they're more addressable and answerable it's a real data Jonathan foreign would it be reasonable to say that um it may or may not be true that the free energy principle is applicable to certain Real World Systems but not that the principle itself is wrong just that it's not applicable what does anyone want to add on that Ali go for it uh actually I came across a kind of a situation that kind of contradicts some of the claims of active inference or fep uh about their scope of applicability recently so I'm not sure if you're familiar with Stefan ferner's uh some of some of Stephen Thurman's recent work but basically uh he claims that uh complex systems um include a set of systems that are only non-markopian and non-ergotic systems but on the other hand we had this notion we have this requirement for any system that is to be modeled in active inference framework to be ergotic and markovian systems although in some recent literature they've dropped this requirement for the system to be ergotic but again I believe uh a kind of local ergoticity needs to be present in order for the system to be to be modeled in fep or active inference framework so uh as as far as I know the scope of applicability is at least so far uh not strictly uh defined or let's say it's not something that can be restricted in a definitional way but there are degrees of applicabilities so for instance um in uh Dalton's Dalton's active Edibles weak markup when a week blankets paper uh he has this notion of uh degrees of blanketedness uh that helps us to deliver distinguish between the systems that have effective markup blankets and the otherwise linear systems uh that doesn't contain any kind of um effective blanketedness uh so briefly he claims that for higher dimensional and complex systems we we can apply these Bayesian mechanical framework uh but as for linear systems although theoretically it is applicable for those systems as well but it wouldn't result in an interesting uh an interesting uh Behavior because it would basically be a kind of trivial thing to apply uh these Frameworks for a simple or simple in in the sense of being linear systems thank you ollie very um very deep answer Michael yeah I also read in some context that this fep would explain how a system can come into the steady state but it cannot explain how it comes out why what triggers um the system to go out of that steady state but this is constantly observed right I mean we are not always in a steady state but also jump into other states so I was I don't know whether this is an implication exactly from what Ali you said but I said that's why this free energy principle could not be applied to living systems even I think yes thank you well a lot of perspectives let's like Focus that kind of question on on the material of chapter five which is the mammalian nervous system and behavior so with copious citations and empirical evidence they're going to be talking about places where the fep and active have been applied and so this is going to be much more empirical and tangible and anatomical than previous chapters so whereas the generative model proposed in chapter four and the high and the low road by which that generative model is reached in chapters three and two were kind of in principle here we're going to see a lot more about what it looks like in practice and that's going to mean that it's in reference to a specific kind of system like specific brain regions and it's also going to mean that it's answerable to empirical data and that it's been published according to professional communication channels signifying that it had unique explanation or predictive power so a lot of these are like fascinating questions about the hard and soft limits of applicability of different methods and we'll see in chapter five how that plays out in practice so again just write anything or raise your hand if you'd like to to explore so this chapter is not intended as the final word on process theories it's simply the interpretation that seems most consistent with the currently available evidence and length constraints on the book nors are aimed to endorse a specific process Theory but to illustrate how the ideas in the previous chapters may be put to work so if we were reading an anatomy textbook or a psychology textbook it would be like this is how it is the elbow is connected to this and this concept does this but the way that we're going to be looking at the coming examples are like representative of how models are constructed that do describe real systems of Interest um I'll um bring your question into here and and feel free to you can continue this or add any more information on what type of generalist tools might help Coda is certainly one generalist tool that helps and then there's many statistical approaches that are more technical so right now we're going to be approaching this just from the kind of like learning side but the way that these models are implemented the code is generally available and so this also provides some specific tools and there may be other tools also but at least tools that we use for learning help us with Bayesian mechanics in our engagement with it and then the tools that actually Implement those statistical models and then there may also be other tools as well which would be interesting to explore um they describe the layout of the chapter which is going to be first focusing on one of the most well-studied neural systems which is the mammalian cortex architecture they're then going to expand into the reflex arc of the spinal cord and that will help us look at the continuous time models of perception and action and then in section 5.4 talking about decision making all right so in the end of chapter four there were some representations that looked like this and this is showing two um related views on a generative model on the left is a hierarchical predictive processing model where there are just as a graphical convention top-down predictions and bottom-up sensory data and so this is represented as kind of like a skyscraper just without reference to time the tilde means Through Time this in practice becomes unrolled through these message passing architectures and we talked a little bit about that last week here they're going to return to that idea so the skyscraper the kinds of ways in which hierarchical predictive processing architectures can be visualized or represented with a base graph those schemes are going to be associated with stereotype circuitry and there's like also coming from a long history of taking pictures of the brain an understanding of what the circuitry is in terms of synaptic connectivity and so on so they're going to describe a little bit about this cortical column and as an insect neuroscientist it's fun to read all this because I just think well this is one way it could be but certainly all of these anatomical details they don't even necessarily have to be that way for mammals but they definitely don't have to be that way outside of mammals but connecting it to the reality of what is empirically measured helps ground Theory and so figure 5.1 is going to be a side by side of the anatomy of the cortical layers has this mapping been done for the Clans the synaptic connectivity of the um whatever it is 302 neurons in the C elegans um for the most part has been completed so snap connectivity does Maps do exist oh I I mean the sort of the the relationship between that map and and the message passing um that we we see here um sort of the mapping between what we're seeing on the left um and what we're seeing in the middle and the right it would be awesome as far as I know there is not an explicit um nematode or even um fruit fly or any other um type of mapping but I think that's very exciting work because there's like a whole nematode simulation and there are with brain and body and biomechanics and um there are similar projects for the drosophila um Fly so the um bulk of the work of these authors Kristen at all and and building on the legacy of SPM most of the work has been done in human neuroanatomy and so not many people were considering Beyond like the human neuroimaging case until more recently so these six layers of the cortex are defined histologically so just from a tissue definition they have some morphological differences and they also have like some gene expression and protein expression differences and these edges represent physical structural connections amongst different um regions it's juxtaposed and and these are kind of the outputs inputs and outputs with these the thalamus and so on sending inputs into layer four and then this kind of resonance processing happening within a columnar unit and then the outputs of this layer 5 cell going on to the decision making areas that are going to be discussed in Section 5 4. and it's juxtaposed in kind of a visual rhetorical Style with statistical representations about what these populations of cells might be doing so that is helping connect the semantics of these variables like this one is an error on this and this one's a variance estimator on that and this one's getting inputs about this all those kinds of things that we want to like talk about what a statistical variable is doing and mapping that onto empirically observed patterns of neuroanatomy now this is going to be kind of course grained this columnar unit which is repeated thousands of times in the mammalian cortex is going to be abstracted from the deep to the superficial so this is that layer um one two three four five six superficial towards the surface of the brain and then the deeper regions of the cortex so that is going to be like one unit in this figure 5.2 they have simplified what's happening within a cortical region to highlight what is happening amongst cortical regions and so there's processing happening within a column and also columns can serve as bottom up and top down for each other so they're interacting laterally from an anatomical perspective however in this representation the one on the right is like sending top-down predictions to the one on the left and then bottom up prediction errors or sensory inputs are coming up to the one on the right so this is showing that predictive processing architectures can be implemented laterally across cortical columns and this is at the root of a lot of current computational modeling efforts just we'll leave it there and we'll return to it can I ask um is that are they the Taylor series that is that what that is the ascending prediction or it's a I I was trying to understand this Taylor series and it seemed to be like a a way of um creating a set of protections from a function and you know so whenever I looked at this I thought that's the Taylor series am I wrong in that it it's a great insight and I think uh as with with many of these things it's like if you if you needed and want it to be you can connect those locations so for example here's figure 4.3 and um in the discrete time case we were making explicit predictions about the past present and future in the continuous time case rather than making explicit predictions about the past present and future we have the x hidden State variable first derivative second derivative and so on on X so that is like the Taylor series coefficients now one could propose what if what this cortical column was doing was X so it is getting sensory input this is going to be raw sensory input coming in or just from some other location and it is going to be doing the role of inference about X and then it is going to be constrained and constraining the rate of change in X so let's assign the computational function of this middle unit to like the derivative of x and this one to the second derivative of x so this architecture could Implement something like a Taylor series approximation you can make it that way in silico and then you'll know or if you're talking about real brains of course they're not actually doing a Taylor series approximation on the coefficients but computationally they might be doing something akin to it so thank you Phillip yeah thank you so figure 5.1 highlighted how layer 5 of the cortex is going to be projecting out here's layer five projecting out to some of these motor and decision-making regions so now we're going to treat the descending prediction from that cortical region we're just going to have it up here starting from the BET cells in layer 5 of the motor cortex so here's the BET cells here's the motor cortex here's like the brain is sending a descending prediction two in this case a cross-section of the spinal cord foreign sensory data is incoming to the spinal cord through proprioception afferent means away from the sensor efferent means to the sensor so proprioceptive data are coming away from the sensor and in the actual histology of the spinal cord descending predictions about proprioception how one is expected to feel and then the incoming proprioceptive information are being juxtaposed in this discrepancy variable subtracting the predictions from the incoming data so just a simple differencing results in an error that says how much muscle contraction would be required to meet the prediction so if the prediction is exactly what the incoming data are the discrepancy is zero and no motor action is instigated if it's non-zero motor auction would be instigated lower motor neurons then cause this muscle contraction or relaxation ensuring that the resulting proprioceptive data match descending predictions so we can have continuous this is a an opportunity and and where continuous time models have been studied a lot because the incoming sensory data are continuous for example um perceived uh weight or just a different tactile Sensations and then the outgoing Behavior can also be framed in a continuous setting like the elbow angle and so this is like a simple statistical architecture that situates motor action as resolving the discrepancy between predictions incoming and data incoming they move on to another region of the mammalian nervous system cortical layer 5 targets several other structures beyond the spinal cord amongst these is the stratum with these regions and a lot is known about that region in terms of gene expression and protein expression and neurophysiology so they're describing some of the empirical neurophysiology neuroanatomy talking about figure 5.4 it's going to come up several Pages later though so just keep that in mind they're going to be talking about policy selection in the context of expected free energy so here we didn't need to talk about planning at all and continuous time models are very Adept at describing these situations where no explicit planning is required but still adoptive action can occur and we revisit that in chapter 8 on continuous time models but now we're going to look at like decision making kind of classical psychologist type categorical decision making especially thinking about explicit planning and then they're going to talk about how the architecture works but we'll talk about that when we see it dopamine tone is going to modulate the balance of the two sides of the figure and perturbations of dopamine are going to have some behavioral and cognitive consequences that are completely compatible with this model and just in general the anatomy of figure 5 4 is endorsed by evidence from both Clinical Pathology and cellular morphology so it's not the only map you can draw of the territory it isn't the territory itself but the map shown here is compatible with the complexity of the territory okay so now we're going to take those um just like they started the section off on outputs of cortical layer 5 are going to Target other areas not just the spinal cord so we're going to have um one of those cortical outputs sending into this brain region there are going to be two Pathways Illustrated so one might be an effect or the other and dopamine with this gamma variable is um modulating the balance between the two so it's kind of like a rudder the computational rule of dopamine is acting like a Rudder with which one of these Pathways is being deployed at a given time here are what those two pathways are and again this is going to be like a behavioral computational account but it's also consistent with the anatomy and with the clinical findings What's called the indirect pathway is one where the E vector which is our habit the affordances are encoded in e so different opportunities for Action are enumerated in E and the numbers in each of those cells refer to their prior probability so if there's um up down left right there's going to be four elements in e and if it was 1 1 1 1 it means all things are being equal there's no prior bias towards the direction to take conversely in that up down left right case what if it were a hundred one one one that would be equivalent to saying the prior probability on going up is much higher and so in this indirect pathway the e affordance vector is basically being passed on through to policy selection and so policy posterior pi is basically reflecting the policy prior so actions are being selected proportional to how they have been selected in the past the distributions of actions being selected in the indirect pathway is being drawn from the same distribution as habit we can contrast that with what's called by the neurophysiologist the direct pathway here we see that same kind of input coming in but rather than passing e on to Pi we have G so G um is expected free energy functional so it's equation 2.6 and there's other representations and what G is doing is taking in the E which is like not shown but it does come into play so this is not exhaustively showing every variable just trying to only highlight the differences between them really G sharpens the action prior into an action posterior so that is updating the policy prior into the posterior through expected free energy how does expected free energy sharpen or modify the action prior into the action posterior it re-waits policies according to their expected free energy what is expected for energy it's equation 2.6 so there's different decompositions no one of which is simply like how it is but policies are going to be updated in becoming to their posterior likelihood from which actions are actually sampled from and they're going to be sharpened or updated according to according to this Top Line the pragmatic value and the information gain of different policies Michael yeah one question so this posterior is still an expected posterior and we also have in the in the variation free energy another kind of posterior is that true um every variable in Bayesian statistics can be described that's that's going undergoing updating can be described of as having a prior and then data comes in and then there's the posterior so here in particular we're talking about the prior and the posterior on action policies but also we talk about priors and posteriors for other kinds of variables here the focus is how um descending information from the cerebral cortex shapes policy selection with the kind of neurophysiological hypothesis not total expert that habit is encoded or represented Within this brain region but cortical inputs shift the balance towards a direct pathway so this is where we see like deliberative decision making because we end up sharpening policies according to their um expected free energy so let's think about like the famous marshmallow example um where a marshmallow is placed on a table and someone can be taking it or not and they're told about what it is or isn't or anything like that so if somebody had a habit of not taking the marshmallow then this pathway would lead them to not take it if they had a habit of taking it it would lead them to taking it in this case in the direct pathway policies would be evaluated according to their epistemic and pragmatic value so in a model where pragmatic value or sugar and there was a preference for sugar then policy selection would lead to The Taking of the marshmallow if pragmatic value in that model were being defined as like Conformity to the rules then that Conformity would be realized by not taking the marshmallow so I know it's kind of like hard because we're talking on one hand about actual neurophysiology and behavioral patterns but on the other hand about these variables but they're being juxtaposed here to to show how it really does come into play in empirical modeling yes Michael but but all this um it's a planning this is not based on an observation at that moment right and how how does a surprise uh come in there so surprise how can we can can we also expect surprise and take this into account in this um in this expected free energy so this is um showing just a few distilled aspects of this graph this is not the full model observations are coming in and so in that sense surprise being about observations it could be understood to be happening here it's just not being like diagrammed Yana what happens when there are more options than a no nutrient stimulant yes it um always that's where we get into the um figure 9.1 not to look ahead but depending on how the context is set up for the experiment was it a two-choice experiment was it a three-choice experiment and then that is the ethologists challenge to develop the as if View From the Inside the cognitive model of the subject parameterized by their objective behavior in this setting not the only way to use these models here they uh point to how certain dopamine signals that famously incredibly famously look like reward prediction errors so one model of dopamine was like dopamine is the reward molecule and this Schultz 1997 paper was like wait a minute yes when more is received than expected there's a dopamine Spike and that was the pattern that people um were associating with reward but if it's the exact amount that was expected there's no dopamine Spike and if it's less than expected but still a reward there's like another Spike and so that was like wait a minute so it's not just like a thermometer for reward maybe dopamine is doing something like tracking prediction errors so this is kind of like a proto-basian brain proto-predictive coding empirical find it from the dopamine neurophysiology that we now have like much much more resolution on and so active inference provides a specific alternative explanation to these phenomena where we don't need to make all these exceptions to a reward-based model well it's dopamine is signaling reward but then also it does that and also I don't know why it does this we can have a unified perspective with active inference on empirical data here they're going to point to the idea that um specific hypotheses can be formed yeah another reason to use active inference modeling for these kinds of cognitive uh or I mean ultimately neurophysiological settings is that there can be non-invasive measurement of precision parameters and that's called computational phenotyping and Ryan Smith and others have done a lot of work on that table 5.1 is going to list some of the important neurotransmitters and then even though neurotransmitters do different things in different settings and they're not saying otherwise they're going to kind of broadly associate it with a given computational function so they interact and there's neuropeptides and there's all this other stuff happening but broadly here are a bunch of lines of evidence that support and understanding of that neurotransmitter associated with Precision acting on these things thanks for um sharing those Jonah it reminds me of this um 2016 paper they gave ants a choice between um sugar water and um some dopamine drug maybe morphine yeah morphine and they like showed that they could taper down the sugar and the morphine and change a few different things so that um there was like a persistent choice to go to the morphine so I mean yes many many interesting things to explore but just to conclude on this part from above computational phenotyping basically means probing a generative model construct reducing our uncertainty about a generative model through peripheral measurements so for example pupil diameter and eye movements contain a lot of information on somebody's arousal and attention and so you don't need to have like an implantable neurotech per se you could use these non-invasive measurements and previously understood relationships like between pupil size and noradrenaline so that you could actually reduce your uncertainty about noradrenaline levels just by looking at the pupil they talk about heavy in plasticity and different statistical models 5.6 continuous indiscrete hierarchies this is also um a topic that's treated a lot more extensively in live stream 46. active inference models do not contradict folk psychology but they highlight a move from continuous representations at low levels of a neural hierarchy for example continuous sensory input to categorical variables at higher levels especially associated with semantics identification and decision making so we're able to hold categorical beliefs and interface with continuously varying sensory receptors and effectors like muscle length or visual features that is just kind of brought up in these two short paragraphs in 5.6 and then in figure eight point six this is an example of what the generative model looks like so at the higher level there's a missing line here but at the higher level we have a discrete time generative model partially observable Markov decision process pomdp how do we know because it has the Tau minus one Tau Tau plus one so this is making explicit predictions about the past present and future and in this case it's also making categorical inferences so is it a or b or oh it's a and b because those letters are also used here but is it raining or is it sunny and we're just going to have a categorical difference between those two and have that estimate happening past present future but then at each time step there's a continuous time model and so here we can recognize the continuous time model because we see that x x Prime X double Prime and so we have like this big rake Big E pointing down and then here's a smaller one so it's kind of like figure 4.3 here's discrete time Model E pointing down continuous time Model E pointing down and then those are going to be grafted together so we have a higher order slower discrete time model and then a faster continuous time model so this could reflect and this is what they discuss in live stream 46. with um Alex Kiefer Ryan Smith and Maxwell ramstead they discuss how decision making like should I go to the baker or to the barber is occurring in a discrete like way in this decision making model but then the implementation of the decision-making model is happening in a continuous type model which they call motor active inference Mai um so the good thing about figure 4.3 is these are enormously flexible methods this is not like the one and only way an active inference model looks it's really almost bewilderingly the opposite of that this isn't like the zoo of what's out there these are showing some of the structural possibilities for cognitive modeling and there are many possibilities and there's many ways to model the same phenomena um Jana asked how is the continuous hierarchy applied well you can add more information but one can make a hierarchical model where like the higher level was continuous and the output of a given like the Y here we could graft another continuous time model right here so these are like our our Lego kits these are a few Lego constructions that people have made that typify minimal skeletons of cognitive models but what's really important is that the cognitive models that we build are going to have tractable ways to do inference on them because of message passing so then they closed the chapter with this summary visualization so it's the three systems that we learned about in the chapter which is dot cortical column the balance between the indirect and the direct Pathways of policy selection in the basal ganglia midbrain and the action selection in that continuous time model happening via the spinal cord discrepancy detection and so this is kind of reflective and compatible with the actual anatomical connectivity of the body so it's not like proposing a telepathic link between some cell in the brain and like the motor uh unit in the arm so it's compatible with the constraints that exist in the body it explains and predicts different phenomena that are observed and those explanations come not from just trivial well if two things that are touching are influenced then one influences the other but rather with actually these statistical models that even help us understand the progression or different kinds of interventions in different conditions which is where these models have been used most so that's the end of that chapter five but they kind of close with um a reminder that like Neuroscience is a work in progress and um there are so many open questions from the super cellular level like where are the glia where's the immuno aspect to different kinds of everything they're just picking three examples that have been studied in previous papers by these authors and showing how alone and in combination we can use these kinds of models so Jana asked so this is how sensory experiences can be modeled broadly this could help us make sense of sensory experience this isn't like the one and only way to model sensory experience this is like one circuit board statistical model that can help with understanding how incoming proprioception results in outgoing action so it can be used in service of understanding sensory experience but this is not the the final model on sensory experience I hope that that's clear there can be other compositions yes so any other thoughts or comments on this first pass through five Michael yeah but in this figure 5.5 that you just showed uh is still the observation the sensation is actually missing there right so we have action but not the observation um here the input Y is the proprioceptive input but other kinds like visual input is not shown here but that is that speaks to the composability of these models is like we could have an auditory stream and a visual stream and a proprioceptive stream and we can do model comparison and we can develop models that use any mixtures of those and on given computational hardware for a given data set for a given setting for a given client one of those models might be more useful than the other for you okay thank you yeah it's a fun chapter and I it's definitely a context switch because chapter four just goes so hard with the technical details and then 5.3 is really like about our bodies but in that contrast there's been a lot of great discussion so um next week we'll return for the second discussion on five please feel free to ask your questions in the meanwhile so thank you everybody see you next time